# 文章模块接口文档

## 概述

本文档描述了博客系统中文章模块的所有API接口，包括文章管理、分类管理和标签管理三个子模块。所有接口均采用RESTful风格设计，使用统一的响应格式。

## 统一响应格式

所有接口均使用统一的响应格式：

```json
{
  "code": 200,
  "message": "操作成功",
  "data": {},
  "timestamp": 1640995200000
}
```

### 响应字段说明

| 字段 | 类型 | 说明 |
|------|------|------|
| code | Integer | 响应状态码 |
| message | String | 响应消息 |
| data | Object | 响应数据 |
| timestamp | Long | 响应时间戳 |

### 常用状态码

| 状态码 | 说明 |
|--------|------|
| 200 | 操作成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 403 | 禁止访问 |
| 404 | 资源未找到 |
| 500 | 服务器内部错误 |

---

## 1. 文章管理接口

### 1.1 更新文章

**接口地址：** `PUT /api/articles/{id}`

**接口描述：** 更新指定ID的文章信息

**请求参数：**

- **路径参数：**
  - `id` (String, 必填): 文章ID

- **请求体：**
```json
{
  "title": "文章标题",
  "content": "文章内容",
  "summary": "文章摘要",
  "categoryId": "分类ID",
  "tagNames": ["标签1", "标签2"]
}
```

**请求体字段说明：**

| 字段 | 类型 | 必填 | 说明 | 验证规则 |
|------|------|------|------|----------|
| title | String | 是 | 文章标题 | 长度1-200字符 |
| content | String | 是 | 文章内容 | 不能为空 |
| summary | String | 否 | 文章摘要 | 最大500字符 |
| categoryId | String | 是 | 分类ID | 不能为空 |
| tagNames | Set<String> | 否 | 标签名称集合 | 每个标签名长度1-50字符 |

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": "article123",
    "title": "文章标题",
    "content": "文章内容",
    "summary": "文章摘要",
    "status": "DRAFT",
    "category": {
      "id": "category123",
      "name": "技术分享"
    },
    "author": {
      "id": "user123",
      "username": "author",
      "nickname": "作者昵称"
    },
    "tags": [
      {
        "id": "tag123",
        "name": "Java"
      }
    ],
    "createdAt": "2024-01-01T10:00:00",
    "updatedAt": "2024-01-01T11:00:00",
    "publishedAt": null
  },
  "timestamp": 1640995200000
}
```

### 1.2 根据ID查询文章

**接口地址：** `GET /api/articles/{id}`

**接口描述：** 根据文章ID查询文章详情

**请求参数：**

- **路径参数：**
  - `id` (String, 必填): 文章ID

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": "article123",
    "title": "文章标题",
    "content": "文章内容",
    "summary": "文章摘要",
    "status": "PUBLISHED",
    "category": {
      "id": "category123",
      "name": "技术分享"
    },
    "author": {
      "id": "user123",
      "username": "author",
      "nickname": "作者昵称"
    },
    "tags": [
      {
        "id": "tag123",
        "name": "Java"
      }
    ],
    "createdAt": "2024-01-01T10:00:00",
    "updatedAt": "2024-01-01T11:00:00",
    "publishedAt": "2024-01-01T12:00:00"
  },
  "timestamp": 1640995200000
}
```

### 1.3 查询已发布文章列表

**接口地址：** `GET /api/articles/published`

**接口描述：** 分页查询已发布的文章列表，支持按分类和标签过滤

**请求参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| page | Integer | 否 | 0 | 页码（从0开始） |
| size | Integer | 否 | 10 | 每页大小 |
| categoryId | String | 否 | - | 分类ID过滤 |
| tagName | String | 否 | - | 标签名称过滤 |

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "articles": [
      {
        "id": "article123",
        "title": "文章标题",
        "content": "文章内容",
        "summary": "文章摘要",
        "status": "PUBLISHED",
        "category": {
          "id": "category123",
          "name": "技术分享"
        },
        "author": {
          "id": "user123",
          "username": "author",
          "nickname": "作者昵称"
        },
        "tags": [
          {
            "id": "tag123",
            "name": "Java"
          }
        ],
        "createdAt": "2024-01-01T10:00:00",
        "updatedAt": "2024-01-01T11:00:00",
        "publishedAt": "2024-01-01T12:00:00"
      }
    ],
    "totalCount": 100,
    "page": 0,
    "size": 10
  },
  "timestamp": 1640995200000
}
```

### 1.4 查询作者文章列表

**接口地址：** `GET /api/articles/author/{authorId}`

**接口描述：** 分页查询指定作者的文章列表

**请求参数：**

- **路径参数：**
  - `authorId` (String, 必填): 作者ID

- **查询参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| page | Integer | 否 | 0 | 页码（从0开始） |
| size | Integer | 否 | 10 | 每页大小 |

**响应示例：** 同1.3

### 1.5 根据分类ID查询文章列表

**接口地址：** `GET /api/articles/category/{categoryId}`

**接口描述：** 查询指定分类下的所有文章

**请求参数：**

- **路径参数：**
  - `categoryId` (String, 必填): 分类ID

**响应示例：** 同1.3

### 1.6 根据标题关键词搜索文章

**接口地址：** `GET /api/articles/search`

**接口描述：** 根据标题关键词搜索文章

**请求参数：**

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| keyword | String | 是 | 搜索关键词 |

**响应示例：** 同1.3

### 1.7 查询最近发布的文章

**接口地址：** `GET /api/articles/recent`

**接口描述：** 查询最近发布的文章列表

**请求参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| limit | Integer | 否 | 5 | 返回数量限制 |

**响应示例：** 同1.3

---

## 2. 分类管理接口

### 2.1 创建分类

**接口地址：** `POST /api/categories`

**接口描述：** 创建新的文章分类

**请求体：**
```json
{
  "name": "分类名称"
}
```

**请求体字段说明：**

| 字段 | 类型 | 必填 | 说明 | 验证规则 |
|------|------|------|------|----------|
| name | String | 是 | 分类名称 | 长度1-50字符，不能为空 |

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": "category123",
    "name": "技术分享"
  },
  "timestamp": 1640995200000
}
```

### 2.7 分页查询分类及文章数量
- **接口地址**: `GET /api/categories/with-count`
- **接口描述**: 分页查询分类列表，包含每个分类下的文章数量
- **请求参数**: 
  - `page` (int, 可选): 页码，从0开始，默认值为0
  - `size` (int, 可选): 每页大小，默认值为10
- **响应示例**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "categories": [
      {
        "id": 1,
        "name": "技术分享",
        "articleCount": 5
      },
      {
        "id": 2,
        "name": "生活随笔",
        "articleCount": 3
      }
    ],
    "total": 2,
    "page": 0,
    "size": 10,
    "totalPages": 1
  },
  "timestamp": "2024-01-01T12:00:00"
}
```

### 2.2 根据ID查询分类详情

**接口地址：** `GET /api/categories/{id}`

**接口描述：** 根据分类ID查询分类详情

**请求参数：**

- **路径参数：**
  - `id` (String, 必填): 分类ID

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": "category123",
    "name": "技术分享"
  },
  "timestamp": 1640995200000
}
```

### 2.3 查询所有分类

**接口地址：** `GET /api/categories`

**接口描述：** 查询所有分类列表

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "categories": [
      {
        "id": "category123",
        "name": "技术分享"
      },
      {
        "id": "category456",
        "name": "生活随笔"
      }
    ],
    "totalCount": 2
  },
  "timestamp": 1640995200000
}
```

### 2.4 分页查询分类列表

**接口地址：** `GET /api/categories/page`

**接口描述：** 分页查询分类列表

**请求参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| page | Integer | 否 | 0 | 页码（从0开始） |
| size | Integer | 否 | 10 | 每页大小 |

**响应示例：** 同2.3

### 2.5 搜索分类

**接口地址：** `GET /api/categories/search`

**接口描述：** 根据名称关键词搜索分类

**请求参数：**

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| keyword | String | 是 | 搜索关键词 |

**响应示例：** 同2.3

### 2.6 查询最近创建的分类

**接口地址：** `GET /api/categories/recent`

**接口描述：** 查询最近创建的分类列表

**请求参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| limit | Integer | 否 | 5 | 返回数量限制 |

**响应示例：** 同2.3

---

## 3. 标签管理接口

### 3.1 创建标签

**接口地址：** `POST /api/tags`

**接口描述：** 创建新的文章标签

**请求体：**
```json
{
  "name": "标签名称"
}
```

**请求体字段说明：**

| 字段 | 类型 | 必填 | 说明 | 验证规则 |
|------|------|------|------|----------|
| name | String | 是 | 标签名称 | 长度1-50字符，不能为空 |

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": "tag123",
    "name": "Java"
  },
  "timestamp": 1640995200000
}
```

### 3.2 根据ID查询标签详情

**接口地址：** `GET /api/tags/{id}`

**接口描述：** 根据标签ID查询标签详情

**请求参数：**

- **路径参数：**
  - `id` (String, 必填): 标签ID

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": "tag123",
    "name": "Java"
  },
  "timestamp": 1640995200000
}
```

### 3.3 查询所有标签

**接口地址：** `GET /api/tags`

**接口描述：** 查询所有标签列表

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "tags": [
      {
        "id": "tag123",
        "name": "Java"
      },
      {
        "id": "tag456",
        "name": "Spring"
      }
    ],
    "totalCount": 2
  },
  "timestamp": 1640995200000
}
```

### 3.4 分页查询标签

**接口地址：** `GET /api/tags/page`

**接口描述：** 分页查询标签列表

**请求参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| page | Integer | 否 | 0 | 页码（从0开始） |
| size | Integer | 否 | 10 | 每页大小 |

**响应示例：** 同3.3

### 3.5 搜索标签

**接口地址：** `GET /api/tags/search`

**接口描述：** 根据关键词搜索标签

**请求参数：**

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| keyword | String | 是 | 搜索关键词 |

**响应示例：** 同3.3

### 3.6 查询最近创建的标签

**接口地址：** `GET /api/tags/recent`

**接口描述：** 查询最近创建的标签列表

**请求参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| limit | Integer | 否 | 5 | 返回数量限制 |

**响应示例：** 同3.3

### 3.7 分页查询标签及文章数量

**接口地址：** `GET /api/tags/with-count`

**接口描述：** 分页查询标签列表，包含每个标签的文章数量

**请求参数：**

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| page | Integer | 否 | 0 | 页码（从0开始） |
| size | Integer | 否 | 10 | 每页大小 |

**响应示例：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "tags": [
      {
        "id": "tag123",
        "name": "Java",
        "articleCount": 15
      },
      {
        "id": "tag456",
        "name": "Spring",
        "articleCount": 8
      }
    ],
    "totalCount": 2,
    "page": 0,
    "size": 10
  },
  "timestamp": 1640995200000
}
```

---

## 4. 数据模型说明

### 4.1 ArticleResponse（文章响应对象）

| 字段 | 类型 | 说明 |
|------|------|------|
| id | String | 文章ID |
| title | String | 文章标题 |
| content | String | 文章内容 |
| summary | String | 文章摘要 |
| status | String | 文章状态（DRAFT/PUBLISHED） |
| category | CategoryResponse | 分类信息 |
| author | UserResponse | 作者信息 |
| tags | Set<TagResponse> | 标签集合 |
| createdAt | String | 创建时间 |
| updatedAt | String | 更新时间 |
| publishedAt | String | 发布时间 |

### 4.2 CategoryResponse（分类响应对象）

| 字段 | 类型 | 说明 |
|------|------|------|
| id | String | 分类ID |
| name | String | 分类名称 |

### 4.2.1 CategoryWithCountResponse（带文章数量的分类响应对象）

| 字段 | 类型 | 说明 |
|------|------|------|
| id | String | 分类ID |
| name | String | 分类名称 |
| articleCount | Integer | 文章数量 |

### 4.3 TagResponse（标签响应对象）

| 字段 | 类型 | 说明 |
|------|------|------|
| id | String | 标签ID |
| name | String | 标签名称 |

### 4.4 TagWithCountResponse（带文章数量的标签响应对象）

| 字段 | 类型 | 说明 |
|------|------|------|
| id | String | 标签ID |
| name | String | 标签名称 |
| articleCount | Integer | 文章数量 |

### 4.5 UserResponse（用户响应对象）

| 字段 | 类型 | 说明 |
|------|------|------|
| id | String | 用户ID |
| username | String | 用户名 |
| nickname | String | 昵称 |

---

## 5. 错误处理

### 5.1 常见错误响应

**参数错误（400）：**
```json
{
  "code": 400,
  "message": "参数错误: 标题不能为空",
  "data": null,
  "timestamp": 1640995200000
}
```

**资源未找到（404）：**
```json
{
  "code": 404,
  "message": "文章不存在",
  "data": null,
  "timestamp": 1640995200000
}
```

**服务器错误（500）：**
```json
{
  "code": 500,
  "message": "服务器内部错误",
  "data": null,
  "timestamp": 1640995200000
}
```

### 5.2 业务异常说明

| 异常类型 | HTTP状态码 | 错误信息示例 |
|----------|------------|-------------|
| 参数验证失败 | 400 | "参数错误: 标题长度不能超过200字符" |
| 资源不存在 | 404 | "文章不存在" |
| 权限不足 | 403 | "无权限访问该资源" |
| 系统异常 | 500 | "系统繁忙，请稍后重试" |

---

## 6. 注意事项

1. **分页参数**：所有分页接口的页码都从0开始计算
2. **时间格式**：所有时间字段均使用ISO 8601格式（yyyy-MM-ddTHH:mm:ss）
3. **字符编码**：请求和响应均使用UTF-8编码
4. **内容类型**：请求头需设置`Content-Type: application/json`
5. **文章状态**：文章状态包括DRAFT（草稿）和PUBLISHED（已发布）两种
6. **标签处理**：创建或更新文章时，如果标签不存在会自动创建
7. **权限控制**：部分接口需要相应的权限，具体权限要求请参考认证授权文档

---

## 7. 版本信息

- **文档版本**：v1.0.0
- **API版本**：v1
- **最后更新**：2024-01-01
- **维护者**：CleverOnion团队