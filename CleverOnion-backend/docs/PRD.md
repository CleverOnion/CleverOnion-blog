# 个人博客系统产品需求文档 (PRD)

## 1. 项目概述

### 1.1. 项目目标
本项目旨在开发一个现代化、轻量级的个人博客系统。系统核心功能包括文章管理（含分类、标签、评论）、基于 GitHub OAuth2 的用户认证体系以及安全的双 Token 鉴权机制。该系统旨在为博主提供一个专注内容创作、易于管理的发布平台，同时为读者提供流畅、便捷的阅读和互动体验。

### 1.2. 目标用户
- **博主（管理员）**: 系统唯一的内容创作者和管理者。
- **读者（已登录用户）**: 通过 GitHub 登录，可以参与文章评论和互动。
- **访客（未登录用户）**: 可以自由浏览已发布的文章。

---

## 2. 功能需求

### 2.1. 文章模块

#### 2.1.1. 文章管理
- **用户故事**: 作为博主，我希望能够创建、编辑和删除文章，以便管理我的博客内容。
- **功能描述**:
  - **创建文章**: 提供一个富文本编辑器（如 Markdown 编辑器），支持标题、正文、摘要的输入。
  - **编辑文章**: 可以对已存在的文章（包括草稿和已发布）进行内容更新。
  - **删除文章**: 可以将文章永久删除。
  - **文章列表**: 后台管理界面需要提供一个清晰的文章列表，展示文章标题、状态、分类、发布日期等信息，并支持搜索和筛选。

#### 2.1.2. 文章状态
- **用户故事**: 作为博主，我希望能管理文章的不同状态，以便控制内容的可见性。
- **功能描述**:
  - **草稿 (Draft)**: 文章的初始状态，仅博主可见，不会在博客前台展示。
  - **已发布 (Published)**: 文章对所有访客可见。
  - **归档 (Archived)**: 文章不再在主要列表显示，但仍可通过直接链接访问，用于存放过时但有保留价值的内容。

#### 2.1.3. 分类管理
- **用户故事**: 作为博主，我希望能为文章设置分类，以便结构化地组织我的内容。
- **功能描述**:
  - 博主可以创建、编辑、删除分类。
  - 每篇文章只能属于一个分类。
  - 读者可以在前台按分类筛选和浏览文章。

#### 2.1.4. 标签管理
- **用户故事**: 作为博主，我希望能给文章打上多个标签，以便更灵活地标记和关联内容。
- **功能描述**:
  - 博主可以创建、编辑、删除标签。
  - 每篇文章可以关联多个标签。
  - 读者可以在前台点击标签，查看所有包含该标签的文章。

#### 2.1.5. 评论系统
- **用户故事**: 作为登录用户，我希望能对文章发表评论，与其他读者和博主进行交流。
- **功能描述**:
  - 只有通过 GitHub 登录的用户才能发表评论。
  - 评论支持层级回复（盖楼）。
  - 博主可以删除不当评论。
  - 评论区需展示评论者的 GitHub 用户名和头像。

### 2.2. 用户模块

#### 2.2.1. 用户信息
- **用户故事**: 作为用户，我的基本信息（用户名、头像）应该自动从我的 GitHub 账户同步，无需手动设置。
- **功能描述**:
  - 系统不提供用户信息修改功能。
  - 用户的用户名、头像等公开信息在首次通过 GitHub 登录时自动拉取并存储。
  - 用户信息仅用于展示（如评论区），不做他用。

### 2.3. 鉴权模块

#### 2.3.1. GitHub OAuth2 登录
- **用户故事**: 作为访客，我希望能通过我的 GitHub 账户快速登录系统，以便参与评论。
- **功能描述**:
  - 系统首页和文章页的评论区提供“使用 GitHub 登录”的入口。
  - 用户点击后，重定向至 GitHub 授权页面。
  - 用户授权成功后，系统后台完成与 GitHub 的认证流程，并为用户创建会话。
  - 系统不设独立的注册和密码登录功能。

#### 2.3.2. 双 Token 鉴权机制
- **用户故事**: 作为登录用户，我希望我的登录状态是安全的，并且在一定时间内可以保持有效，无需频繁重新登录。
- **功能描述**:
  - 用户登录成功后，系统会签发两个 Token：
    - **Access Token**: 用于访问受保护的 API 接口（如发表评论），生命周期较短（例如 2 小时）。
    - **Refresh Token**: 用于在 Access Token 过期后，无感知地获取新的 Access Token，生命周期较长（例如 7 天）。
  - Access Token 失效后，客户端应使用 Refresh Token 刷新，刷新成功则延长用户登录状态。若 Refresh Token 也失效，则需要用户重新登录。
  - Token 需安全存储在客户端。

---

## 3. 非功能性需求

### 3.1. 安全性
- 所有 API 请求，特别是写操作（创建、删除等），必须经过严格的权限校验。
- 防止常见的 Web 攻击，如 XSS、CSRF、SQL 注入。
- 敏感信息（如 GitHub App Secret）不能硬编码，需通过安全的方式进行配置。

### 3.2. 性能
- 页面加载速度应尽可能快，特别是文章列表页和文章详情页。
- API 响应时间应在 200ms 以内。
- 数据库查询需要进行优化，对常用查询字段建立索引。

### 3.3. 可用性
- 网站界面设计应简洁、直观，易于导航。
- 网站应支持响应式布局，在桌面和移动设备上都有良好的浏览体验。

---

## 4. 范围之外
- **站内信/私信功能**: 本期不做。
- **用户个人主页**: 本期不做。
- **文章搜索功能**: 基础的文章标题搜索可在后台实现，前台全局搜索本期可暂缓。
- **多博主支持**: 系统设计为单人博客，不考虑多用户发布文章的场景。