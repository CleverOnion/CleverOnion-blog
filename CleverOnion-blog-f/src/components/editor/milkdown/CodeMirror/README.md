# CodeMirror ä»£ç ç¼–è¾‘å™¨é›†æˆ

## æ¦‚è¿°

CodeMirror æ˜¯ä¸º CleverOnion-blog-f é¡¹ç›®çš„ Milkdown ç¼–è¾‘å™¨é›†æˆçš„é«˜çº§ä»£ç ç¼–è¾‘åŠŸèƒ½ï¼Œæä¾›äº†è¯­æ³•é«˜äº®ã€ä»£ç è¡¥å…¨ã€æ‹¬å·åŒ¹é…ç­‰ä¸“ä¸šçš„ä»£ç ç¼–è¾‘ä½“éªŒã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **è¯­æ³•é«˜äº®**: æ”¯æŒ 11+ ç§ä¸»æµç¼–ç¨‹è¯­è¨€çš„è¯­æ³•é«˜äº®
- **æ™ºèƒ½è¡¥å…¨**: æä¾›åŸºäºè¯­è¨€çš„ä»£ç è¡¥å…¨å’Œæç¤º
- **æ‹¬å·åŒ¹é…**: è‡ªåŠ¨åŒ¹é…å’Œé«˜äº®å¯¹åº”çš„æ‹¬å·
- **ä»£ç æŠ˜å **: æ”¯æŒä»£ç å—çš„æŠ˜å å’Œå±•å¼€
- **æœç´¢æ›¿æ¢**: å†…ç½®å¼ºå¤§çš„æœç´¢å’Œæ›¿æ¢åŠŸèƒ½
- **å¤šå…‰æ ‡ç¼–è¾‘**: æ”¯æŒå¤šå…‰æ ‡åŒæ—¶ç¼–è¾‘

### ğŸ¨ ç”¨æˆ·ä½“éªŒ
- **è¯­è¨€é€‰æ‹©å™¨**: åŠ¨æ€åˆ‡æ¢ä»£ç å—çš„ç¼–ç¨‹è¯­è¨€
- **å¤åˆ¶åŠŸèƒ½**: ä¸€é”®å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿
- **ä¸»é¢˜é€‚é…**: è‡ªåŠ¨é€‚é…äº®è‰²å’Œæš—è‰²ä¸»é¢˜
- **å“åº”å¼è®¾è®¡**: åœ¨ä¸åŒè®¾å¤‡ä¸Šéƒ½æœ‰è‰¯å¥½çš„æ˜¾ç¤ºæ•ˆæœ

## æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€

| è¯­è¨€ | åˆ«å | æ‰©å±•å |
|------|------|--------|
| JavaScript | js, javascript, jsx | .js, .jsx, .mjs |
| TypeScript | ts, typescript, tsx | .ts, .tsx |
| Python | py, python | .py, .pyw |
| Java | java | .java |
| C++ | cpp, c++, cxx, cc, c | .cpp, .cxx, .cc, .c, .h, .hpp |
| CSS | css | .css |
| HTML | html, htm | .html, .htm |
| JSON | json | .json |
| Markdown | md, markdown | .md, .markdown |
| SQL | sql | .sql |
| XML | xml | .xml |

## ä½¿ç”¨æ–¹æ³•

### 1. åˆ›å»ºä»£ç å—

åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥ä¸‰ä¸ªåå¼•å·å¼€å§‹ä»£ç å—ï¼š

````markdown
```javascript
console.log('Hello, World!');
```
````

### 2. é€‰æ‹©ç¼–ç¨‹è¯­è¨€

- åœ¨ä»£ç å—å³ä¸Šè§’ç‚¹å‡»è¯­è¨€é€‰æ‹©å™¨
- æœç´¢æˆ–é€‰æ‹©æ‰€éœ€çš„ç¼–ç¨‹è¯­è¨€
- ä»£ç å—ä¼šè‡ªåŠ¨åº”ç”¨å¯¹åº”çš„è¯­æ³•é«˜äº®

### 3. ç¼–è¾‘ä»£ç 

- ç‚¹å‡»ä»£ç å—è¿›å…¥ç¼–è¾‘æ¨¡å¼
- äº«å—è¯­æ³•é«˜äº®ã€è‡ªåŠ¨ç¼©è¿›ç­‰åŠŸèƒ½
- ä½¿ç”¨ `Ctrl+C` å¤åˆ¶é€‰ä¸­ä»£ç 
- ä½¿ç”¨ `Ctrl+F` æœç´¢ä»£ç 

### 4. å¤åˆ¶ä»£ç 

- ç‚¹å‡»ä»£ç å—å³ä¸Šè§’çš„å¤åˆ¶æŒ‰é’®
- æ•´ä¸ªä»£ç å—å†…å®¹ä¼šè¢«å¤åˆ¶åˆ°å‰ªè´´æ¿

## é…ç½®é€‰é¡¹

```typescript
interface CodeMirrorFeatureConfig {
  extensions?: Extension[]           // è‡ªå®šä¹‰ CodeMirror æ‰©å±•
  languages?: LanguageDescription[]  // æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€
  theme?: Extension                  // è‡ªå®šä¹‰ä¸»é¢˜
  searchPlaceholder?: string         // æœç´¢æ¡†å ä½ç¬¦
  copyText?: string                  // å¤åˆ¶æŒ‰é’®æ–‡æœ¬
  copyIcon?: string                  // å¤åˆ¶æŒ‰é’®å›¾æ ‡
  onCopy?: (text: string) => void    // å¤åˆ¶å›è°ƒå‡½æ•°
  noResultText?: string              // æ— æœç´¢ç»“æœæç¤º
}
```

## æ–‡ä»¶ç»“æ„

```
CodeMirror/
â”œâ”€â”€ index.ts              # ä¸»è¦é…ç½®å’Œå¯¼å‡º
â”œâ”€â”€ languages.ts          # ç¼–ç¨‹è¯­è¨€å®šä¹‰
â”œâ”€â”€ CodeMirror.css        # æ ·å¼æ–‡ä»¶
â””â”€â”€ README.md            # è¯´æ˜æ–‡æ¡£
```

## æŠ€æœ¯å®ç°

### ä¾èµ–åŒ…

- `@codemirror/commands` - ç¼–è¾‘å™¨å‘½ä»¤
- `@codemirror/view` - è§†å›¾å±‚
- `@codemirror/language` - è¯­è¨€æ”¯æŒ
- `@codemirror/state` - çŠ¶æ€ç®¡ç†
- `codemirror` - æ ¸å¿ƒåŒ…
- `@codemirror/lang-*` - å„ç§è¯­è¨€åŒ…

### é›†æˆæ–¹å¼

1. **é…ç½®å‡½æ•°**: `configureCodeMirror` è´Ÿè´£é…ç½® CodeMirror é€‰é¡¹
2. **è¯­è¨€å®šä¹‰**: `languages.ts` å®šä¹‰æ‰€æœ‰æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€
3. **ç»„ä»¶é›†æˆ**: é€šè¿‡ `codeBlockComponent` é›†æˆåˆ° Milkdown ç¼–è¾‘å™¨
4. **æ ·å¼å®šåˆ¶**: é€šè¿‡ CSS å˜é‡å®ç°ä¸»é¢˜é€‚é…

## è‡ªå®šä¹‰æ‰©å±•

### æ·»åŠ æ–°è¯­è¨€

```typescript
// åœ¨ languages.ts ä¸­æ·»åŠ æ–°è¯­è¨€
LanguageDescription.of({
  name: 'Go',
  alias: ['go', 'golang'],
  extensions: ['go'],
  load: () => import('@codemirror/lang-go').then(m => m.go())
})
```

### è‡ªå®šä¹‰ä¸»é¢˜

```typescript
import { oneDark } from '@codemirror/theme-one-dark'

configureCodeMirror(ctx, {
  theme: oneDark,
  // å…¶ä»–é…ç½®...
})
```

### æ·»åŠ æ‰©å±•

```typescript
import { autocompletion } from '@codemirror/autocomplete'
import { lintGutter } from '@codemirror/lint'

configureCodeMirror(ctx, {
  extensions: [
    autocompletion(),
    lintGutter()
  ],
  // å…¶ä»–é…ç½®...
})
```

## æ ·å¼è‡ªå®šä¹‰

å¯ä»¥é€šè¿‡ä¿®æ”¹ CSS å˜é‡æ¥è‡ªå®šä¹‰ä»£ç ç¼–è¾‘å™¨çš„å¤–è§‚ï¼š

```css
.milkdown {
  --crepe-color-surface: #f8f9fa;        /* èƒŒæ™¯è‰² */
  --crepe-color-outline: #e1e5e9;        /* è¾¹æ¡†è‰² */
  --crepe-color-primary: #805610;        /* ä¸»è‰²è°ƒ */
  --crepe-color-on-surface: #201b13;     /* æ–‡æœ¬è‰² */
}
```

## æ€§èƒ½ä¼˜åŒ–

- **æŒ‰éœ€åŠ è½½**: è¯­è¨€åŒ…é‡‡ç”¨åŠ¨æ€å¯¼å…¥ï¼Œå‡å°‘åˆå§‹åŒ…å¤§å°
- **ç¼“å­˜æœºåˆ¶**: å·²åŠ è½½çš„è¯­è¨€ä¼šè¢«ç¼“å­˜ï¼Œé¿å…é‡å¤åŠ è½½
- **è™šæ‹Ÿæ»šåŠ¨**: å¤§æ–‡ä»¶ç¼–è¾‘æ—¶ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æå‡æ€§èƒ½

## æµè§ˆå™¨å…¼å®¹æ€§

- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è¯­æ³•é«˜äº®ä¸ç”Ÿæ•ˆ**
   - æ£€æŸ¥è¯­è¨€åç§°æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤å¯¹åº”çš„è¯­è¨€åŒ…å·²å®‰è£…

2. **å¤åˆ¶åŠŸèƒ½ä¸å·¥ä½œ**
   - æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒ Clipboard API
   - ç¡®è®¤ç½‘ç«™è¿è¡Œåœ¨ HTTPS ç¯å¢ƒ

3. **æ ·å¼æ˜¾ç¤ºå¼‚å¸¸**
   - æ£€æŸ¥ CSS æ–‡ä»¶æ˜¯å¦æ­£ç¡®å¯¼å…¥
   - ç¡®è®¤ CSS å˜é‡å®šä¹‰æ­£ç¡®

### è°ƒè¯•æ–¹æ³•

```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æ£€æŸ¥ CodeMirror çŠ¶æ€
console.log(editor.view.state.doc.toString())
```

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-08-01)
- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… æ”¯æŒ 11 ç§ç¼–ç¨‹è¯­è¨€
- âœ… é›†æˆè¯­æ³•é«˜äº®å’Œä»£ç è¡¥å…¨
- âœ… æ·»åŠ å¤åˆ¶å’Œæœç´¢åŠŸèƒ½
- âœ… å®ç°ä¸»é¢˜é€‚é…

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿› CodeMirror åŠŸèƒ½ï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. å‘èµ· Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚